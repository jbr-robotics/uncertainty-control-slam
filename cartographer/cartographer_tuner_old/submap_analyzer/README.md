# Submap Analyzer

A GUI tool for analyzing submaps from Cartographer in real-time.

## Overview

The Submap Analyzer is a tool for visualizing and analyzing submaps generated by Google Cartographer. It provides a real-time view of submaps as they are created, allowing for immediate inspection and analysis.

## Architecture

The Submap Analyzer follows a Model-View-ViewModel (MVVM) architecture:

- **Model**: The ROS2 node (`SubmapAnalyzerNode`) that communicates with Cartographer and processes submaps.
- **ViewModel**: The `SubmapViewModel` class that handles data preparation and business logic.
- **View**: The GUI components that display the data to the user.

### Components

- **SubmapAnalyzerNode**: A ROS2 node that subscribes to Cartographer's submap list topic and queries submaps.
- **SubmapViewModel**: Handles data preparation and business logic for the GUI.
- **SubmapAnalyzerGUI**: The main GUI class that integrates the ViewModel and UI components.
- **UI Components**:
  - **ControlPanel**: Panel with buttons for controlling the application.
  - **SubmapListPanel**: Panel for displaying the list of submaps.
  - **SubmapDisplayPanel**: Panel for displaying the selected submap.
  - **MetricsPanel**: Panel for displaying metrics about the selected submap.
  - **DebugInfoPanel**: Panel for displaying debug information.

## Features

- Real-time monitoring of submaps from Cartographer
- Visualization of submaps as PGM images
- Metrics display for submap analysis
- Manual reload capability for refreshing submaps
- Debug information for troubleshooting

## Usage

1. Start Cartographer with the appropriate configuration.
2. Launch the Submap Analyzer:
   ```
   ros2 run quality_estimator submap_analyzer
   ```
3. The GUI will display submaps as they are created by Cartographer.
4. Select a submap from the list to view it in detail.
5. Use the reload button to manually refresh the selected submap.
6. Use the debug button to view detailed information about the node's state.

## Development

### Adding New Metrics

To add a new metric to the metrics panel:

1. Update the `SubmapViewModel` to include the new metric in the submap data.
2. Use the `add_custom_metric` method of the `MetricsPanel` class to add the metric to the display.

### Adding New Features

To add new features to the Submap Analyzer:

1. Update the appropriate component in the GUI.
2. Add any necessary methods to the ViewModel.
3. Update the node if ROS2 communication is required.

## Troubleshooting

If submaps are not appearing in the GUI:

1. Check that Cartographer is running and publishing submaps.
2. Use the debug button to view the node's state.
3. Check the logs for any error messages.
4. Verify that the output directory exists and is writable. 